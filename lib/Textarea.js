import PropTypes from"prop-types";import classNames from"classnames";import React,{Component}from"react";var isArray=Array.isArray,isArray_1=isArray,commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},freeGlobal="object"==typeof commonjsGlobal&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,_freeGlobal=freeGlobal,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=_freeGlobal||freeSelf||Function("return this")(),_root=root,Symbol$1=_root.Symbol,_Symbol=Symbol$1,objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=_Symbol?_Symbol.toStringTag:void 0;function getRawTag(e){var t=hasOwnProperty.call(e,symToStringTag),a=e[symToStringTag];try{e[symToStringTag]=void 0}catch(e){}var r=nativeObjectToString.call(e);return t?e[symToStringTag]=a:delete e[symToStringTag],r}var _getRawTag=getRawTag,objectProto$1=Object.prototype,nativeObjectToString$1=objectProto$1.toString;function objectToString(e){return nativeObjectToString$1.call(e)}var _objectToString=objectToString,nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag$1=_Symbol?_Symbol.toStringTag:void 0;function baseGetTag(e){return null==e?void 0===e?undefinedTag:nullTag:symToStringTag$1&&symToStringTag$1 in Object(e)?_getRawTag(e):_objectToString(e)}var _baseGetTag=baseGetTag;function isObjectLike(e){return null!=e&&"object"==typeof e}var isObjectLike_1=isObjectLike,symbolTag="[object Symbol]";function isSymbol(e){return"symbol"==typeof e||isObjectLike_1(e)&&_baseGetTag(e)==symbolTag}var isSymbol_1=isSymbol,reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(e,t){if(isArray_1(e))return!1;var a=typeof e;return!("number"!=a&&"symbol"!=a&&"boolean"!=a&&null!=e&&!isSymbol_1(e))||(reIsPlainProp.test(e)||!reIsDeepProp.test(e)||null!=t&&e in Object(t))}var _isKey=isKey;function isObject(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var isObject_1=isObject,asyncTag="[object AsyncFunction]",funcTag="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(e){if(!isObject_1(e))return!1;var t=_baseGetTag(e);return t==funcTag||t==genTag||t==asyncTag||t==proxyTag}var isFunction_1=isFunction,coreJsData=_root["__core-js_shared__"],_coreJsData=coreJsData,maskSrcKey=function(){var e=/[^.]+$/.exec(_coreJsData&&_coreJsData.keys&&_coreJsData.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function isMasked(e){return!!maskSrcKey&&maskSrcKey in e}var _isMasked=isMasked,funcProto=Function.prototype,funcToString=funcProto.toString;function toSource(e){if(null!=e){try{return funcToString.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var _toSource=toSource,reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$2=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$1=objectProto$2.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$1).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){return!(!isObject_1(e)||_isMasked(e))&&(isFunction_1(e)?reIsNative:reIsHostCtor).test(_toSource(e))}var _baseIsNative=baseIsNative;function getValue(e,t){return null==e?void 0:e[t]}var _getValue=getValue;function getNative(e,t){var a=_getValue(e,t);return _baseIsNative(a)?a:void 0}var _getNative=getNative,nativeCreate=_getNative(Object,"create"),_nativeCreate=nativeCreate;function hashClear(){this.__data__=_nativeCreate?_nativeCreate(null):{},this.size=0}var _hashClear=hashClear;function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var _hashDelete=hashDelete,HASH_UNDEFINED="__lodash_hash_undefined__",objectProto$3=Object.prototype,hasOwnProperty$2=objectProto$3.hasOwnProperty;function hashGet(e){var t=this.__data__;if(_nativeCreate){var a=t[e];return a===HASH_UNDEFINED?void 0:a}return hasOwnProperty$2.call(t,e)?t[e]:void 0}var _hashGet=hashGet,objectProto$4=Object.prototype,hasOwnProperty$3=objectProto$4.hasOwnProperty;function hashHas(e){var t=this.__data__;return _nativeCreate?void 0!==t[e]:hasOwnProperty$3.call(t,e)}var _hashHas=hashHas,HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(e,t){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=_nativeCreate&&void 0===t?HASH_UNDEFINED$1:t,this}var _hashSet=hashSet;function Hash(e){var t=-1,a=null==e?0:e.length;for(this.clear();++t<a;){var r=e[t];this.set(r[0],r[1])}}Hash.prototype.clear=_hashClear,Hash.prototype.delete=_hashDelete,Hash.prototype.get=_hashGet,Hash.prototype.has=_hashHas,Hash.prototype.set=_hashSet;var _Hash=Hash;function listCacheClear(){this.__data__=[],this.size=0}var _listCacheClear=listCacheClear;function eq(e,t){return e===t||e!=e&&t!=t}var eq_1=eq;function assocIndexOf(e,t){for(var a=e.length;a--;)if(eq_1(e[a][0],t))return a;return-1}var _assocIndexOf=assocIndexOf,arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(e){var t=this.__data__,a=_assocIndexOf(t,e);return!(a<0)&&(a==t.length-1?t.pop():splice.call(t,a,1),--this.size,!0)}var _listCacheDelete=listCacheDelete;function listCacheGet(e){var t=this.__data__,a=_assocIndexOf(t,e);return a<0?void 0:t[a][1]}var _listCacheGet=listCacheGet;function listCacheHas(e){return _assocIndexOf(this.__data__,e)>-1}var _listCacheHas=listCacheHas;function listCacheSet(e,t){var a=this.__data__,r=_assocIndexOf(a,e);return r<0?(++this.size,a.push([e,t])):a[r][1]=t,this}var _listCacheSet=listCacheSet;function ListCache(e){var t=-1,a=null==e?0:e.length;for(this.clear();++t<a;){var r=e[t];this.set(r[0],r[1])}}ListCache.prototype.clear=_listCacheClear,ListCache.prototype.delete=_listCacheDelete,ListCache.prototype.get=_listCacheGet,ListCache.prototype.has=_listCacheHas,ListCache.prototype.set=_listCacheSet;var _ListCache=ListCache,Map=_getNative(_root,"Map"),_Map=Map;function mapCacheClear(){this.size=0,this.__data__={hash:new _Hash,map:new(_Map||_ListCache),string:new _Hash}}var _mapCacheClear=mapCacheClear;function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}var _isKeyable=isKeyable;function getMapData(e,t){var a=e.__data__;return _isKeyable(t)?a["string"==typeof t?"string":"hash"]:a.map}var _getMapData=getMapData;function mapCacheDelete(e){var t=_getMapData(this,e).delete(e);return this.size-=t?1:0,t}var _mapCacheDelete=mapCacheDelete;function mapCacheGet(e){return _getMapData(this,e).get(e)}var _mapCacheGet=mapCacheGet;function mapCacheHas(e){return _getMapData(this,e).has(e)}var _mapCacheHas=mapCacheHas;function mapCacheSet(e,t){var a=_getMapData(this,e),r=a.size;return a.set(e,t),this.size+=a.size==r?0:1,this}var _mapCacheSet=mapCacheSet;function MapCache(e){var t=-1,a=null==e?0:e.length;for(this.clear();++t<a;){var r=e[t];this.set(r[0],r[1])}}MapCache.prototype.clear=_mapCacheClear,MapCache.prototype.delete=_mapCacheDelete,MapCache.prototype.get=_mapCacheGet,MapCache.prototype.has=_mapCacheHas,MapCache.prototype.set=_mapCacheSet;var _MapCache=MapCache,FUNC_ERROR_TEXT="Expected a function";function memoize(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(FUNC_ERROR_TEXT);var a=function(){var r=arguments,o=t?t.apply(this,r):r[0],n=a.cache;if(n.has(o))return n.get(o);var s=e.apply(this,r);return a.cache=n.set(o,s)||n,s};return a.cache=new(memoize.Cache||_MapCache),a}memoize.Cache=_MapCache;var memoize_1=memoize,MAX_MEMOIZE_SIZE=500;function memoizeCapped(e){var t=memoize_1(e,function(e){return a.size===MAX_MEMOIZE_SIZE&&a.clear(),e}),a=t.cache;return t}var _memoizeCapped=memoizeCapped,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=_memoizeCapped(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(rePropName,function(e,a,r,o){t.push(r?o.replace(reEscapeChar,"$1"):a||e)}),t}),_stringToPath=stringToPath;function arrayMap(e,t){for(var a=-1,r=null==e?0:e.length,o=Array(r);++a<r;)o[a]=t(e[a],a,e);return o}var _arrayMap=arrayMap,INFINITY=1/0,symbolProto=_Symbol?_Symbol.prototype:void 0,symbolToString=symbolProto?symbolProto.toString:void 0;function baseToString(e){if("string"==typeof e)return e;if(isArray_1(e))return _arrayMap(e,baseToString)+"";if(isSymbol_1(e))return symbolToString?symbolToString.call(e):"";var t=e+"";return"0"==t&&1/e==-INFINITY?"-0":t}var _baseToString=baseToString;function toString(e){return null==e?"":_baseToString(e)}var toString_1=toString;function castPath(e,t){return isArray_1(e)?e:_isKey(e,t)?[e]:_stringToPath(toString_1(e))}var _castPath=castPath,INFINITY$1=1/0;function toKey(e){if("string"==typeof e||isSymbol_1(e))return e;var t=e+"";return"0"==t&&1/e==-INFINITY$1?"-0":t}var _toKey=toKey;function baseGet(e,t){for(var a=0,r=(t=_castPath(t,e)).length;null!=e&&a<r;)e=e[_toKey(t[a++])];return a&&a==r?e:void 0}var _baseGet=baseGet;function get(e,t,a){var r=null==e?void 0:_baseGet(e,t);return void 0===r?a:r}var get_1=get,classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},objectWithoutProperties=function(e,t){var a={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(a[r]=e[r]);return a},possibleConstructorReturn=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},getId=function(e){return get_1(e,"id")},hasId=function(e){return!!getId(e)},errorChanged=function(e,t){return hasId(t)&&getId(e)!==getId(t)},MarginX=20,Popover=function(e){function t(e){classCallCheck(this,t);var a=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.handleOnResize=function(){a.$parent&&a.adjustPosition()},a.$parent=null,a.$popover=null,a}return inherits(t,Component),createClass(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleOnResize,{passive:!0})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleOnResize,{passive:!0})}},{key:"render",value:function(){var e=this,t=this.props,a=t.content,r=t.containerClassName,o=t.popoverClassName,n=classNames(r,"c-popover__container"),s=classNames(o,"c-popover");return React.createElement("div",{className:n},React.createElement("div",{ref:function(t){e.$popover=t},className:s},React.createElement("div",null,a)))}},{key:"adjust",value:function(e){this.$parent=e,this.adjustPosition()}},{key:"adjustPosition",value:function(){var e=this,t=this.calculateLeft(),a=this.calculateMaxWidth();window.requestAnimationFrame(function(){if(e.$popover){e.$popover.style.left=t+"px",e.$popover.style.maxWidth=a+"px";var r=e.calculateTop();e.$popover.style.top=r+"px"}})}},{key:"calculateTop",value:function(){var e=this.$popover.clientHeight/2;return this.$parent.clientHeight/2-e}},{key:"calculateLeft",value:function(){return this.$parent.getBoundingClientRect().width}},{key:"calculateMaxWidth",value:function(){var e=this.$parent.getBoundingClientRect();return document.body.clientWidth-e.left-e.width-MarginX}}]),t}(),getDisplayName=function(e){return e.displayName||e.name||"Component"},withPopover=function(e){var t=function(t){function a(e){classCallCheck(this,a);var t=possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.handleOnChange=function(){var e=t.props.onChange;t.destroyPopover(),e.apply(void 0,arguments)},t.state={currentErrorMessage:e.errorMessage,isPopoverDismissed:!1},t.$root=null,t.$popover=null,t}return inherits(a,Component),createClass(a,[{key:"componentDidMount",value:function(){this.positionPopover()}},{key:"componentWillReceiveProps",value:function(e){var t=e.errorMessage,a=this.state.currentErrorMessage;hasId(t)||this.destroyPopover(),errorChanged(a,t)&&this.attachNewPopover(e)}},{key:"componentDidUpdate",value:function(){this.positionPopover()}},{key:"componentWillUnmount",value:function(){this.destroyPopover()}},{key:"render",value:function(){var t=this,a=this.props,r=a.wrapperClassName,o=objectWithoutProperties(a,["wrapperClassName"]),n=this.state,s=n.currentErrorMessage,i=n.isPopoverDismissed,c=hasId(s)&&!i?React.createElement(Popover,{ref:function(e){t.$popover=e},key:s.id,content:s.text}):null;return React.createElement("span",{className:"flex flex-auto "+r},c,React.createElement("span",{className:"c-popover__component-wrapper",ref:function(e){t.$root=e}},React.createElement(e,_extends({onChange:this.handleOnChange},o))))}},{key:"attachNewPopover",value:function(e){var t=e.errorMessage;this.setState({currentErrorMessage:t,isPopoverDismissed:!1})}},{key:"destroyPopover",value:function(){this.setState({isPopoverDismissed:!0})}},{key:"positionPopover",value:function(){var e=this.state,t=e.currentErrorMessage,a=e.isPopoverDismissed;hasId(t)&&!a&&this.$popover.adjust(this.$root)}}]),a}();return t.displayName="WithPopover("+getDisplayName(e)+")",t.defaultProps={wrapperClassName:"",errorMessage:{},onChange:function(){}},t.propTypes={errorMessage:PropTypes.shape({id:PropTypes.string,text:PropTypes.string}),wrapperClassName:PropTypes.string,onChange:PropTypes.func},t};Popover.displayName="Popover",Popover.propTypes={content:PropTypes.string.isRequired,containerClassName:PropTypes.string,popoverClassName:PropTypes.string},Popover.defaultProps={containerClassName:"",popoverClassName:""};var isEmpty=function(e){return null===e||void 0===e||Number.isNaN(e)||""===e},ViewOnlyText=function(e){var t=e.value,a=classNames({"gray-secondary":isEmpty(t)}),r=isEmpty(t)?"N/A":t;return React.createElement("div",{className:a},r)};ViewOnlyText.displayName="ViewOnlyText",ViewOnlyText.defaultProps={value:null},ViewOnlyText.propTypes={value:PropTypes.oneOfType([PropTypes.string,PropTypes.number])};var Textarea=function(e){function t(){var e,a,r;classCallCheck(this,t);for(var o=arguments.length,n=Array(o),s=0;s<o;s++)n[s]=arguments[s];return a=r=possibleConstructorReturn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n))),r.handleOnChange=function(e){var t=e.target.value,a=r.props,o=a.validRegex,n=a.onChange;o&&null===t.match(o)||n(t)},r.handleOnKeyDown=function(e){var t=r.props.onSubmit,a=e.key,o=e.target.value;"Enter"===a&&t(o)},possibleConstructorReturn(r,a)}return inherits(t,Component),createClass(t,[{key:"render",value:function(){var e=this.props,t=e.placeholder,a=e.className,r=e.inputRef,o=e.maxLength,n=e.value,s=e.viewOnly,i=e.autoFocus,c=e.showLimit,l=e.limitClassName,p=e.containerClassName;if(s)return this.renderAsViewOnly();var u=classNames("textarea",a);return React.createElement("div",{className:classNames("full-width",p)},React.createElement("textarea",{ref:r,className:u,maxLength:o,placeholder:t,value:n||"",autoFocus:i,onChange:this.handleOnChange,onKeyDown:this.handleOnKeyDown}),o&&!s&&c&&React.createElement("div",{className:"flex justify-end"},React.createElement("span",{className:l},o-n.length," characters remaining")))}},{key:"renderAsViewOnly",value:function(){var e=this.props.value;return React.createElement(ViewOnlyText,{value:e})}}]),t}();Textarea.displayName="Textarea",Textarea.defaultProps={className:"",containerClassName:"",limitClassName:"fs-12 red p1/2",maxLength:120,placeholder:"",value:"",validRegex:null,viewOnly:!1,autoFocus:!1,showLimit:!1,inputRef:function(){},onChange:function(){},onSubmit:function(){}},Textarea.propTypes={className:PropTypes.string,containerClassName:PropTypes.string,limitClassName:PropTypes.string,inputRef:PropTypes.func,maxLength:PropTypes.number,placeholder:PropTypes.string,value:PropTypes.string,validRegex:PropTypes.object,viewOnly:PropTypes.bool,onChange:PropTypes.func,onSubmit:PropTypes.func,autoFocus:PropTypes.bool,showLimit:PropTypes.bool};var TextareaWithPopover=withPopover(Textarea);TextareaWithPopover.displayName="Textarea";export default TextareaWithPopover;export{Textarea};
//# sourceMappingURL=Textarea.js.map
